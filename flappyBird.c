
#include<stdlib.h>
#include<stdio.h>
#include<stdbool.h>
#include<time.h>

// global variable
volatile int pixel_buffer_start; 
volatile int PS2_ptr;
volatile int pipe_coor[4][2];
volatile int pipe_pre1;
volatile int pipe_pre2;
volatile int bird_coor, falling, score, pipe_speed;
volatile char byte1 = 0, byte2 = 0, byte3 = 0;
volatile bool play;
#define pipe_gap 60
#define flap_height 30
#define bird_h 12
#define bird_w 17
// game logic
void initial();
void gameCont();
bool checkPosition();
// VGA display
void plot_pixel(int x, int y, short int line_color);
void wait_for_vsync();
void clear_screen();
void clear_partial_screen();
void draw();
void draw_pipe(int id);
void draw_bird();
void score_HEX() ;
void draw_start();
void draw_end();
// interrupt config
void set_A9_IRQ_stack(void);
void enable_A9_interrupts(void);
void config_GIC(void);
void config_PS2();
void PS2_ISR(void);

const unsigned short bird_color[204] ={
    0x400, 0x400, 0x400, 0x400, 0x400, 0x400, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x400, 0x400, 0x400, 0x400, 
    0x400, 0x400, 0x400, 0x400, 0x0, 0x0, 0xd800, 0xd800, 0xd800, 0xd800, 0x0, 0xffff, 0xffff, 0x0, 0x400, 0x400, 0x400, 
    0x400, 0x400, 0x400, 0x0, 0xd800, 0xd800, 0xd800, 0xd800, 0xd800, 0x0, 0xffff, 0xffff, 0xffff, 0xffff, 0x0, 0x400, 0x400, 
    0x400, 0x400, 0x400, 0x0, 0xd800, 0xd800, 0xd800, 0xd800, 0xd800, 0x0, 0xffff, 0xffff, 0xffff, 0x0, 0xffff, 0x0, 0x400, 
    0x400, 0x0, 0x0, 0x0, 0x0, 0xd800, 0xd800, 0xd800, 0xd800, 0x0, 0xffff, 0xffff, 0xffff, 0x0, 0xffff, 0x0, 0x400, 
    0x0, 0xffff, 0xffff, 0xffff, 0xffff, 0x0, 0xd800, 0xd800, 0xd800, 0x0, 0xffff, 0xffff, 0xffff, 0x0, 0xffff, 0x0, 0x400, 
    0x0, 0xffff, 0xffff, 0xffff, 0xffff, 0xffff, 0x0, 0xd800, 0xd800, 0xd800, 0x0, 0xffff, 0xffff, 0xffff, 0xffff, 0x0, 0x400, 
    0x0, 0xffff, 0xffff, 0xffff, 0xffff, 0xffff, 0x0, 0xd800, 0xd800, 0xd800, 0xd800, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 
    0x400, 0x0, 0xffff, 0xffff, 0xffff, 0x0, 0xd800, 0xd800, 0xd800, 0xd800, 0x0, 0xffe0, 0xffe0, 0xffe0, 0xffe0, 0xffe0, 0xffe0, 
    0x400, 0x400, 0x0, 0x0, 0x0, 0xd800, 0xd800, 0xd800, 0xd800, 0x0, 0xffe0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 
    0x400, 0x400, 0x0, 0xd800, 0xd800, 0xd800, 0xd800, 0xd800, 0xd800, 0xd800, 0x0, 0xffe0, 0xffe0, 0xffe0, 0xffe0, 0xffe0, 0x0, 
    0x400, 0x400, 0x400, 0x0, 0x0, 0xd800, 0xd800, 0xd800, 0xd800, 0xd800, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x400
};

const unsigned short start_page[2400] ={
    0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 
    0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 
    0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 
    0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 
    0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0xa81f, 0xa81f, 0xa81f, 0xa81f, 0xa81f, 0x0, 0xa81f, 0x0, 0x0, 0x0, 0x0, 0xa81f, 0xa81f, 0xa81f, 0xa81f, 0x0, 0x0, 0xa81f, 0xa81f, 0xa81f, 0xa81f, 0xa81f, 0x0, 0xa81f, 0xa81f, 0xa81f, 0xa81f, 0x0, 0xa81f, 0xa81f, 0xa81f, 0xa81f, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0xa81f, 0xa81f, 0xa81f, 0xa81f, 0xa81f, 0x0, 0xa81f, 0xa81f, 0xa81f, 0xa81f, 0xa81f, 0x0, 0xa81f, 0xa81f, 0xa81f, 0xa81f, 0x0, 0xa81f, 0xa81f, 0xa81f, 0xa81f, 0x0, 0xa81f, 0xa81f, 0xa81f, 0xa81f, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 
    0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0xa81f, 0x0, 0xa81f, 0xa81f, 0x0, 0xa81f, 0x0, 0x0, 0x0, 0x0, 0xa81f, 0xa81f, 0x0, 0x0, 0x0, 0x0, 0xa81f, 0xa81f, 0x0, 0xa81f, 0xa81f, 0x0, 0xa81f, 0xa81f, 0x0, 0x0, 0x0, 0xa81f, 0xa81f, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0xa81f, 0x0, 0xa81f, 0xa81f, 0x0, 0x0, 0xa81f, 0x0, 0xa81f, 0xa81f, 0x0, 0xa81f, 0xa81f, 0x0, 0x0, 0x0, 0xa81f, 0xa81f, 0x0, 0x0, 0x0, 0xa81f, 0xa81f, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 
    0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0xa81f, 0x0, 0x0, 0xa81f, 0x0, 0xa81f, 0x0, 0x0, 0x0, 0x0, 0xa81f, 0x0, 0x0, 0x0, 0x0, 0x0, 0xa81f, 0x0, 0x0, 0x0, 0xa81f, 0x0, 0xa81f, 0x0, 0x0, 0x0, 0x0, 0xa81f, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0xa81f, 0x0, 0x0, 0xa81f, 0x0, 0x0, 0xa81f, 0x0, 0x0, 0xa81f, 0x0, 0xa81f, 0x0, 0x0, 0x0, 0x0, 0xa81f, 0x0, 0x0, 0x0, 0x0, 0xa81f, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 
    0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0xa81f, 0xa81f, 0xa81f, 0xa81f, 0x0, 0xa81f, 0x0, 0x0, 0x0, 0x0, 0xa81f, 0xa81f, 0xa81f, 0x0, 0x0, 0xa81f, 0xa81f, 0xa81f, 0xa81f, 0xa81f, 0xa81f, 0x0, 0x0, 0xa81f, 0xa81f, 0xa81f, 0x0, 0xa81f, 0xa81f, 0xa81f, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0xa81f, 0xa81f, 0xa81f, 0xa81f, 0x0, 0x0, 0xa81f, 0xa81f, 0xa81f, 0xa81f, 0x0, 0xa81f, 0xa81f, 0xa81f, 0x0, 0x0, 0x0, 0xa81f, 0xa81f, 0xa81f, 0x0, 0x0, 0xa81f, 0xa81f, 0xa81f, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 
    0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0xa81f, 0x0, 0x0, 0x0, 0x0, 0xa81f, 0x0, 0x0, 0x0, 0x0, 0xa81f, 0x0, 0x0, 0x0, 0x0, 0x0, 0xa81f, 0x0, 0x0, 0x0, 0xa81f, 0x0, 0x0, 0x0, 0x0, 0xa81f, 0x0, 0xa81f, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0xa81f, 0x0, 0x0, 0x0, 0x0, 0x0, 0xa81f, 0xa81f, 0xa81f, 0x0, 0x0, 0xa81f, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0xa81f, 0x0, 0x0, 0x0, 0x0, 0xa81f, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 
    0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0xa81f, 0x0, 0x0, 0x0, 0x0, 0xa81f, 0xa81f, 0x0, 0x0, 0x0, 0xa81f, 0xa81f, 0x0, 0x0, 0x0, 0x0, 0xa81f, 0x0, 0x0, 0x0, 0xa81f, 0x0, 0x0, 0x0, 0xa81f, 0xa81f, 0x0, 0xa81f, 0xa81f, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0xa81f, 0x0, 0x0, 0x0, 0x0, 0x0, 0xa81f, 0x0, 0x0, 0xa81f, 0x0, 0xa81f, 0xa81f, 0x0, 0x0, 0x0, 0x0, 0x0, 0xa81f, 0xa81f, 0x0, 0x0, 0x0, 0xa81f, 0xa81f, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 
    0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0xa81f, 0x0, 0x0, 0x0, 0x0, 0xa81f, 0xa81f, 0xa81f, 0xa81f, 0x0, 0xa81f, 0xa81f, 0xa81f, 0xa81f, 0x0, 0x0, 0xa81f, 0x0, 0x0, 0x0, 0xa81f, 0x0, 0xa81f, 0xa81f, 0xa81f, 0xa81f, 0x0, 0xa81f, 0xa81f, 0xa81f, 0xa81f, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0xa81f, 0x0, 0x0, 0x0, 0x0, 0x0, 0xa81f, 0x0, 0x0, 0xa81f, 0x0, 0xa81f, 0xa81f, 0xa81f, 0xa81f, 0x0, 0xa81f, 0xa81f, 0xa81f, 0xa81f, 0x0, 0xa81f, 0xa81f, 0xa81f, 0xa81f, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 
    0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 
    0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0xa81f, 0xa81f, 0xa81f, 0xa81f, 0x0, 0xa81f, 0xa81f, 0xa81f, 0xa81f, 0xa81f, 0x0, 0x0, 0xa81f, 0xa81f, 0xa81f, 0xa81f, 0xa81f, 0x0, 0xa81f, 0xa81f, 0xa81f, 0xa81f, 0x0, 0xa81f, 0xa81f, 0xa81f, 0xa81f, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0xa81f, 0xa81f, 0xa81f, 0xa81f, 0xa81f, 0xa81f, 0xa81f, 0x0, 0xa81f, 0xa81f, 0xa81f, 0xa81f, 0xa81f, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 
    0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0xa81f, 0xa81f, 0x0, 0x0, 0x0, 0x0, 0xa81f, 0x0, 0xa81f, 0xa81f, 0x0, 0x0, 0xa81f, 0xa81f, 0x0, 0xa81f, 0xa81f, 0x0, 0xa81f, 0xa81f, 0x0, 0x0, 0x0, 0xa81f, 0xa81f, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0xa81f, 0xa81f, 0xa81f, 0x0, 0x0, 0x0, 0xa81f, 0xa81f, 0x0, 0xa81f, 0xa81f, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 
    0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0xa81f, 0x0, 0x0, 0x0, 0x0, 0x0, 0xa81f, 0x0, 0x0, 0xa81f, 0x0, 0x0, 0xa81f, 0x0, 0x0, 0x0, 0xa81f, 0x0, 0xa81f, 0x0, 0x0, 0x0, 0x0, 0xa81f, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0xa81f, 0x0, 0x0, 0x0, 0x0, 0xa81f, 0x0, 0x0, 0x0, 0xa81f, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 
    0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0xa81f, 0xa81f, 0xa81f, 0x0, 0x0, 0xa81f, 0xa81f, 0xa81f, 0xa81f, 0x0, 0xa81f, 0xa81f, 0xa81f, 0xa81f, 0xa81f, 0xa81f, 0x0, 0xa81f, 0x0, 0x0, 0x0, 0x0, 0xa81f, 0xa81f, 0xa81f, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0xa81f, 0x0, 0x0, 0x0, 0x0, 0xa81f, 0x0, 0x0, 0x0, 0xa81f, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 
    0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0xa81f, 0x0, 0x0, 0xa81f, 0x0, 0x0, 0x0, 0x0, 0x0, 0xa81f, 0x0, 0x0, 0x0, 0xa81f, 0x0, 0xa81f, 0x0, 0x0, 0x0, 0x0, 0xa81f, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0xa81f, 0x0, 0x0, 0x0, 0x0, 0xa81f, 0x0, 0x0, 0x0, 0xa81f, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 
    0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0xa81f, 0xa81f, 0x0, 0x0, 0xa81f, 0x0, 0x0, 0x0, 0x0, 0x0, 0xa81f, 0x0, 0x0, 0x0, 0xa81f, 0x0, 0xa81f, 0xa81f, 0x0, 0x0, 0x0, 0xa81f, 0xa81f, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0xa81f, 0x0, 0x0, 0x0, 0x0, 0xa81f, 0xa81f, 0x0, 0xa81f, 0xa81f, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 
    0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0xa81f, 0xa81f, 0xa81f, 0xa81f, 0x0, 0x0, 0xa81f, 0x0, 0x0, 0x0, 0x0, 0x0, 0xa81f, 0x0, 0x0, 0x0, 0xa81f, 0x0, 0xa81f, 0xa81f, 0xa81f, 0xa81f, 0x0, 0xa81f, 0xa81f, 0xa81f, 0xa81f, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0xa81f, 0x0, 0x0, 0x0, 0x0, 0xa81f, 0xa81f, 0xa81f, 0xa81f, 0xa81f, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 
    0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 
    0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0xa81f, 0xa81f, 0xa81f, 0xa81f, 0x0, 0xa81f, 0xa81f, 0xa81f, 0xa81f, 0xa81f, 0xa81f, 0xa81f, 0x0, 0x0, 0xa81f, 0xa81f, 0xa81f, 0xa81f, 0xa81f, 0x0, 0xa81f, 0xa81f, 0xa81f, 0xa81f, 0xa81f, 0x0, 0xa81f, 0xa81f, 0xa81f, 0xa81f, 0xa81f, 0xa81f, 0xa81f, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 
    0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0xa81f, 0xa81f, 0x0, 0x0, 0x0, 0x0, 0x0, 0xa81f, 0xa81f, 0xa81f, 0x0, 0x0, 0x0, 0x0, 0xa81f, 0xa81f, 0x0, 0xa81f, 0xa81f, 0x0, 0x0, 0xa81f, 0x0, 0xa81f, 0xa81f, 0x0, 0x0, 0x0, 0xa81f, 0xa81f, 0xa81f, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 
    0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0xa81f, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0xa81f, 0x0, 0x0, 0x0, 0x0, 0x0, 0xa81f, 0x0, 0x0, 0x0, 0xa81f, 0x0, 0x0, 0xa81f, 0x0, 0x0, 0xa81f, 0x0, 0x0, 0x0, 0x0, 0xa81f, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 
    0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0xa81f, 0xa81f, 0xa81f, 0x0, 0x0, 0x0, 0x0, 0xa81f, 0x0, 0x0, 0x0, 0x0, 0xa81f, 0xa81f, 0xa81f, 0xa81f, 0xa81f, 0xa81f, 0x0, 0x0, 0xa81f, 0xa81f, 0xa81f, 0xa81f, 0x0, 0x0, 0x0, 0x0, 0xa81f, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 
    0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0xa81f, 0x0, 0x0, 0x0, 0x0, 0xa81f, 0x0, 0x0, 0x0, 0x0, 0x0, 0xa81f, 0x0, 0x0, 0x0, 0xa81f, 0x0, 0x0, 0xa81f, 0xa81f, 0xa81f, 0x0, 0x0, 0x0, 0x0, 0x0, 0xa81f, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 
    0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0xa81f, 0xa81f, 0x0, 0x0, 0x0, 0x0, 0xa81f, 0x0, 0x0, 0x0, 0x0, 0x0, 0xa81f, 0x0, 0x0, 0x0, 0xa81f, 0x0, 0x0, 0xa81f, 0x0, 0x0, 0xa81f, 0x0, 0x0, 0x0, 0x0, 0xa81f, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 
    0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0xa81f, 0xa81f, 0xa81f, 0xa81f, 0x0, 0x0, 0x0, 0x0, 0xa81f, 0x0, 0x0, 0x0, 0x0, 0x0, 0xa81f, 0x0, 0x0, 0x0, 0xa81f, 0x0, 0x0, 0xa81f, 0x0, 0x0, 0xa81f, 0x0, 0x0, 0x0, 0x0, 0xa81f, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 
    0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 
    0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 
    0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0
};

const unsigned short end_page[2400] ={
    0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 
    0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 
    0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 
    0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 
    0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 
    0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 
    0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 
    0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 
    0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0xa81f, 0xa81f, 0xa81f, 0xa81f, 0x0, 0x0, 0x0, 0xa81f, 0xa81f, 0xa81f, 0xa81f, 0xa81f, 0x0, 0xa81f, 0x0, 0x0, 0x0, 0xa81f, 0x0, 0xa81f, 0xa81f, 0xa81f, 0xa81f, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0xa81f, 0xa81f, 0xa81f, 0xa81f, 0xa81f, 0x0, 0xa81f, 0x0, 0x0, 0x0, 0xa81f, 0x0, 0xa81f, 0xa81f, 0xa81f, 0xa81f, 0x0, 0xa81f, 0xa81f, 0xa81f, 0xa81f, 0xa81f, 0x0, 0x0, 0x0, 0x0, 0x0, 0xa81f, 0x0, 0x0, 0xa81f, 0x0, 0x0, 0xa81f, 0x0, 0x0, 0x0, 0x0, 
    0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0xa81f, 0xa81f, 0x0, 0x0, 0x0, 0x0, 0x0, 0xa81f, 0xa81f, 0x0, 0xa81f, 0xa81f, 0x0, 0xa81f, 0xa81f, 0x0, 0xa81f, 0xa81f, 0x0, 0xa81f, 0xa81f, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0xa81f, 0xa81f, 0x0, 0xa81f, 0xa81f, 0x0, 0xa81f, 0x0, 0x0, 0x0, 0xa81f, 0x0, 0xa81f, 0xa81f, 0x0, 0x0, 0x0, 0x0, 0xa81f, 0x0, 0xa81f, 0xa81f, 0x0, 0x0, 0x0, 0x0, 0x0, 0xa81f, 0x0, 0x0, 0xa81f, 0x0, 0x0, 0xa81f, 0x0, 0x0, 0x0, 0x0, 
    0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0xa81f, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0xa81f, 0x0, 0x0, 0x0, 0xa81f, 0x0, 0xa81f, 0xa81f, 0xa81f, 0xa81f, 0xa81f, 0x0, 0xa81f, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0xa81f, 0x0, 0x0, 0x0, 0xa81f, 0x0, 0xa81f, 0x0, 0x0, 0x0, 0xa81f, 0x0, 0xa81f, 0x0, 0x0, 0x0, 0x0, 0x0, 0xa81f, 0x0, 0x0, 0xa81f, 0x0, 0x0, 0x0, 0x0, 0x0, 0xa81f, 0x0, 0x0, 0xa81f, 0x0, 0x0, 0xa81f, 0x0, 0x0, 0x0, 0x0, 
    0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0xa81f, 0x0, 0x0, 0x0, 0x0, 0x0, 0xa81f, 0xa81f, 0xa81f, 0xa81f, 0xa81f, 0xa81f, 0x0, 0xa81f, 0x0, 0xa81f, 0x0, 0xa81f, 0x0, 0xa81f, 0xa81f, 0xa81f, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0xa81f, 0x0, 0x0, 0x0, 0xa81f, 0x0, 0xa81f, 0x0, 0x0, 0x0, 0xa81f, 0x0, 0xa81f, 0xa81f, 0xa81f, 0x0, 0x0, 0x0, 0xa81f, 0xa81f, 0xa81f, 0xa81f, 0x0, 0x0, 0x0, 0x0, 0x0, 0xa81f, 0x0, 0x0, 0xa81f, 0x0, 0x0, 0xa81f, 0x0, 0x0, 0x0, 0x0, 
    0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0xa81f, 0x0, 0xa81f, 0xa81f, 0x0, 0x0, 0x0, 0xa81f, 0x0, 0x0, 0x0, 0xa81f, 0x0, 0xa81f, 0x0, 0x0, 0x0, 0xa81f, 0x0, 0xa81f, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0xa81f, 0x0, 0x0, 0x0, 0xa81f, 0x0, 0x0, 0xa81f, 0xa81f, 0xa81f, 0x0, 0x0, 0xa81f, 0x0, 0x0, 0x0, 0x0, 0x0, 0xa81f, 0xa81f, 0xa81f, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0xa81f, 0x0, 0x0, 0xa81f, 0x0, 0x0, 0xa81f, 0x0, 0x0, 0x0, 0x0, 
    0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0xa81f, 0x0, 0x0, 0xa81f, 0x0, 0x0, 0x0, 0xa81f, 0x0, 0x0, 0x0, 0xa81f, 0x0, 0xa81f, 0x0, 0x0, 0x0, 0xa81f, 0x0, 0xa81f, 0xa81f, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0xa81f, 0xa81f, 0x0, 0xa81f, 0xa81f, 0x0, 0x0, 0xa81f, 0xa81f, 0xa81f, 0x0, 0x0, 0xa81f, 0xa81f, 0x0, 0x0, 0x0, 0x0, 0xa81f, 0x0, 0x0, 0xa81f, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 
    0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0xa81f, 0xa81f, 0xa81f, 0xa81f, 0xa81f, 0x0, 0x0, 0xa81f, 0x0, 0x0, 0x0, 0xa81f, 0x0, 0xa81f, 0x0, 0x0, 0x0, 0xa81f, 0x0, 0xa81f, 0xa81f, 0xa81f, 0xa81f, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0xa81f, 0xa81f, 0xa81f, 0xa81f, 0xa81f, 0x0, 0x0, 0x0, 0xa81f, 0x0, 0x0, 0x0, 0xa81f, 0xa81f, 0xa81f, 0xa81f, 0x0, 0x0, 0xa81f, 0x0, 0x0, 0xa81f, 0x0, 0x0, 0x0, 0x0, 0x0, 0xa81f, 0x0, 0x0, 0xa81f, 0x0, 0x0, 0xa81f, 0x0, 0x0, 0x0, 0x0, 
    0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 
    0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 
    0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 
    0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 
    0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 
    0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 
    0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 
    0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 
    0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 
    0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 
    0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 
    0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 
    0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 
    0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 
    0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0

};

//address_map_arm.h
/* This files provides address values that exist in the system */
/* Memory */
#define DDR_BASE              0x00000000
#define DDR_END               0x3FFFFFFF
#define A9_ONCHIP_BASE        0xFFFF0000
#define A9_ONCHIP_END         0xFFFFFFFF
#define SDRAM_BASE            0xC0000000
#define SDRAM_END             0xC3FFFFFF
#define FPGA_ONCHIP_BASE      0xC8000000
#define FPGA_ONCHIP_END       0xC803FFFF
#define FPGA_CHAR_BASE        0xC9000000
#define FPGA_CHAR_END         0xC9001FFF
/* Cyclone V FPGA devices */
#define LEDR_BASE             0xFF200000
#define HEX3_HEX0_BASE        0xFF200020
#define HEX5_HEX4_BASE        0xFF200030
#define SW_BASE               0xFF200040
#define KEY_BASE              0xFF200050
#define JP1_BASE              0xFF200060
#define JP2_BASE              0xFF200070
#define PS2_BASE              0xFF200100
#define PS2_DUAL_BASE         0xFF200108
#define JTAG_UART_BASE        0xFF201000
#define JTAG_UART_2_BASE      0xFF201008
#define IrDA_BASE             0xFF201020
#define TIMER_BASE            0xFF202000
#define AV_CONFIG_BASE        0xFF203000
#define PIXEL_BUF_CTRL_BASE   0xFF203020
#define CHAR_BUF_CTRL_BASE    0xFF203030
#define AUDIO_BASE            0xFF203040
#define VIDEO_IN_BASE         0xFF203060
#define ADC_BASE              0xFF204000
/* Cyclone V HPS devices */
#define HPS_GPIO1_BASE        0xFF709000
#define HPS_TIMER0_BASE       0xFFC08000
#define HPS_TIMER1_BASE       0xFFC09000
#define HPS_TIMER2_BASE       0xFFD00000
#define HPS_TIMER3_BASE       0xFFD01000
#define FPGA_BRIDGE           0xFFD0501C
/* ARM A9 MPCORE devices */
#define   PERIPH_BASE         0xFFFEC000    // base address of peripheral devices
#define   MPCORE_PRIV_TIMER   0xFFFEC600    // PERIPH_BASE + 0x0600
/* Interrupt controller (GIC) CPU interface(s) */
#define MPCORE_GIC_CPUIF      0xFFFEC100    // PERIPH_BASE + 0x100
#define ICCICR                0x00          // offset to CPU interface control reg
#define ICCPMR                0x04          // offset to interrupt priority mask reg
#define ICCIAR                0x0C          // offset to interrupt acknowledge reg
#define ICCEOIR               0x10          // offset to end of interrupt reg
/* Interrupt controller (GIC) distributor interface(s) */
#define MPCORE_GIC_DIST       0xFFFED000    // PERIPH_BASE + 0x1000
#define ICDDCR                0x00          // offset to distributor control reg
#define ICDISER               0x100         // offset to interrupt set-enable regs
#define ICDICER               0x180         // offset to interrupt clear-enable regs
#define ICDIPTR               0x800         // offset to interrupt processor targets regs
#define ICDICFR               0xC00         // offset to interrupt configuration regs
#define	USER_MODE                               0b10000
#define	FIQ_MODE				0b10001
#define	IRQ_MODE				0b10010
#define	SVC_MODE				0b10011
#define	ABORT_MODE				0b10111
#define	UNDEF_MODE				0b11011
#define	SYS_MODE				0b11111
#define	INT_ENABLE				0b01000000
#define	INT_DISABLE				0b11000000
	
//interrupt_ID.h
/* This file provides interrupt IDs */
/* FPGA interrupts (there are 64 in total; only a few are defined below) */
#define	INTERVAL_TIMER_IRQ                                              72
#define	KEYS_IRQ		 					73
#define	FPGA_IRQ2	 						74
#define	FPGA_IRQ3	 						75
#define	FPGA_IRQ4	 						76
#define	FPGA_IRQ5	 						77
#define	AUDIO_IRQ							78
#define	PS2_IRQ		 						79
#define	JTAG_IRQ		 					80
#define	IrDA_IRQ		 					81
#define	FPGA_IRQ10							82
#define	JP1_IRQ								83
#define	JP2_IRQ								84
#define	FPGA_IRQ13							85
#define	FPGA_IRQ14							86
#define	FPGA_IRQ15							87
#define	FPGA_IRQ16							88
#define	PS2_DUAL_IRQ                                                    89
#define	FPGA_IRQ18							90
#define	FPGA_IRQ19							91
/* ARM A9 MPCORE devices (there are many; only a few are defined below) */
#define	MPCORE_GLOBAL_TIMER_IRQ                         27
#define	MPCORE_PRIV_TIMER_IRQ                           29
#define	MPCORE_WATCHDOG_IRQ				30
/* HPS devices (there are many; only a few are defined below) */
#define	HPS_UART0_IRQ	   				194
#define	HPS_UART1_IRQ	   				195
#define	HPS_GPIO0_IRQ	        		  	196
#define	HPS_GPIO1_IRQ	        		  	197
#define	HPS_GPIO2_IRQ	        		  	198
#define	HPS_TIMER0_IRQ	        		 	199
#define	HPS_TIMER1_IRQ	        		 	200
#define	HPS_TIMER2_IRQ	        		 	201
#define	HPS_TIMER3_IRQ	        		 	202
#define	HPS_WATCHDOG0_IRQ	     			203
#define	HPS_WATCHDOG1_IRQ	     			204


int main(void){
    //set interrupt START
    set_A9_IRQ_stack();
    config_GIC();
    config_PS2();
    enable_A9_interrupts();
    
    // initialization
    volatile int * pixel_ctrl_ptr = (int *)0xFF203020;
    play = false;
    srand(time(NULL));
    initial();
    
	
    // set  pixel buffer 
    *(pixel_ctrl_ptr + 1) = 0xC8000000; 
    wait_for_vsync();
    pixel_buffer_start = *pixel_ctrl_ptr;
    clear_screen(); 
    draw();
    draw_start();
    *(pixel_ctrl_ptr + 1) = 0xC0000000;
    pixel_buffer_start = *(pixel_ctrl_ptr + 1); // we draw on the back buffer
    
    while (1){
        if (play){
            initial();
            clear_screen();
            do{
                gameCont();
                draw();
                wait_for_vsync();
                pixel_buffer_start = *(pixel_ctrl_ptr + 1);
            }while (checkPosition());
            play = false;
            draw();
            draw_end();
            draw_start();
            wait_for_vsync();
            pixel_buffer_start = *(pixel_ctrl_ptr + 1);
        }
    }
}
void initial(){
    for (int i=0; i<4; i++){
        pipe_coor[i][0] = i*88 + 100;
        pipe_coor[i][1] = rand()%160+20;
    }
    falling = 1;
    bird_coor = 100;    
    score = 0;
    pipe_speed = 4;
    volatile int pipe_pre1 = 100;
    volatile int pipe_pre2 = 100;
}

void gameCont(){
    bird_coor += falling;
    falling = falling + 2;
    for (int i=0; i<4;i++){
        pipe_coor[i][0] -= pipe_speed;
        if (pipe_coor[i][0] <= 20-bird_w && 20 - bird_w - pipe_coor[i][0] < pipe_speed){
            score += 1;
            if (score%5 == 0)
                pipe_speed += 1;
        }
        if (pipe_coor[i][0] <=-22){
            pipe_coor[i][0] = pipe_coor[i][0] + 4*88;
            pipe_coor[i][1] = rand()%160+20;
        }
    }
    
}
bool checkPosition(){
    for (int i=0; i<4;i++)
        if (pipe_coor[i][0]>20-bird_w && pipe_coor[i][0]<20+bird_w 
                && (pipe_coor[i][1]>bird_coor || pipe_coor[i][1]+pipe_gap<bird_coor+bird_h))
            return false;
    if (bird_coor>240-bird_h)
        return false;
    return true;
}

void draw(){
    clear_screen();
    for (int i=0; i<4;i++)
        draw_pipe(i);
    draw_bird();
	score_HEX();
}
void draw_start(){
    for (int i=0; i<80; i++)
        for (int j=0; j<30; j++)
            if (start_page[j*80 + i] != 0x0)
                plot_pixel(i, j, start_page[j*80 + i]);
}

void draw_end(){
    for (int i=0; i<80; i++)
        for (int j=0; j<30; j++)
            if (end_page[j*80 + i] != 0x0)
                plot_pixel(i, 30+j, end_page[j*80 + i]);
}

void draw_bird(){
    for (int i=0; i<bird_w; i++)
        for (int j=0; j<bird_h; j++)
            if (bird_color[j*bird_w + i] != 0x400)
                plot_pixel(20+i, j+bird_coor, bird_color[j*bird_w + i]);
}

void draw_pipe(int id){
    for (int i=0; i<20; i++)
        for (int j=0; j<240; j++)
            if (j<pipe_coor[id][1]-5 || j>pipe_coor[id][1]+pipe_gap+5)
                plot_pixel(pipe_coor[id][0]+i, j, 0x07E0);
    for (int i=-2; i<22; i++){
        for (int j = 0; j<5; j++){
            plot_pixel(pipe_coor[id][0]+i, pipe_coor[id][1]-j, 0x07E0);
            plot_pixel(pipe_coor[id][0]+i, pipe_coor[id][1]+pipe_gap+j, 0x07E0);
        }
    }
}

void plot_pixel(int x, int y, short int line_color){
    if (x>=0 && x<320 && y>=0 &&y<240)
        *(short int *)(pixel_buffer_start + (y << 10) + (x << 1)) = line_color;
}

void clear_screen(){
    for (int x=0; x<320; x++)
        for (int y=0; y<240;y++)
            plot_pixel(x,y,0x0000);
}

void clear_partial_screen(){
    for (int x=20; x<40; x++)
        for (int y=0; y<240; y++)
            plot_pixel(x,y,0x0000);
    int coor =  pipe_coor[0][0]+2*pipe_speed;
    while (coor >= -22){
        for (int x=-2; x<22; x++)
            for (int y=0; y<240; y++)
                plot_pixel(x+coor,y,0x0000);
    }
}

void wait_for_vsync(){
    volatile int * pixel_ctrl_ptr = (int *)0xFF203020;
    *pixel_ctrl_ptr = 1;
    register int status = *(pixel_ctrl_ptr + 3);
    while(status & 0x1)
        status = *(pixel_ctrl_ptr + 3);; // reading status
} 

void score_HEX() {
    volatile int * HEX3_HEX0_ptr = (int *)HEX3_HEX0_BASE;
    volatile int * HEX5_HEX4_ptr = (int *)HEX5_HEX4_BASE;
    
    unsigned char seven_seg_decode_table[] = {
        0x3F, 0x06, 0x5B, 0x4F, 0x66, 0x6D, 0x7D, 0x07,
        0x7F, 0x67, 0x77, 0x7C, 0x39, 0x5E, 0x79, 0x71};
    unsigned char hex_segs[] = {0, 0, 0, 0, 0, 0, 0, 0};
    unsigned int shift_buffer, nibble;
    unsigned char code;
    
    shift_buffer = score;
    for (int i = 0; i < 6; ++i) {
        nibble = shift_buffer %10 ; // character is in rightmost nibble
        code = seven_seg_decode_table[nibble];
        hex_segs[i] = code;
        shift_buffer = shift_buffer /10;
    }
    /* drive the hex displays */
    *(HEX3_HEX0_ptr) = *(int *)(hex_segs);
    *(HEX5_HEX4_ptr) = *(int *)(hex_segs + 4);
}



/* Keyboard Interrupt */

// Define the IRQ exception handler
void __attribute__((interrupt)) __cs3_isr_irq(void){
    // Read the ICCIAR from the processor interface
    int address = MPCORE_GIC_CPUIF + ICCIAR;
    int int_ID = *((int *)address);
    if (int_ID == PS2_IRQ){ // check if interrupt is from the KEYs
        PS2_ISR();
    }
    else while (1);
    // if unexpected, then stay here
    // Write to the End of Interrupt Register (ICCEOIR)
    address = MPCORE_GIC_CPUIF + ICCEOIR;
    *((int *)address) = int_ID;
    return;
}

// Define the remaining exception handlers
void __attribute__((interrupt)) __cs3_reset(void){ while (1); }
void __attribute__((interrupt)) __cs3_isr_undef(void){ while (1); }
void __attribute__((interrupt)) __cs3_isr_swi(void){ while (1); }
void __attribute__((interrupt)) __cs3_isr_pabort(void){ while (1); }
void __attribute__((interrupt)) __cs3_isr_dabort(void){ while (1); }
void __attribute__((interrupt)) __cs3_isr_fiq(void){ while (1); }

// Initialize the banked stack pointer register for IRQ mode
void set_A9_IRQ_stack(void){
    int stack, mode;
    stack = A9_ONCHIP_END - 7; // top of A9 onchip memory, aligned to 8 bytes 
    // change processor to IRQ mode with interrupts disabled
    mode = INT_DISABLE | IRQ_MODE;
    asm("msr cpsr, %[ps]" : : [ps] "r"(mode));
    // set banked stack pointer 
    asm("mov sp, %[ps]" : : [ps] "r"(stack));
    // go back to SVC mode before executing subroutine return!
    mode = INT_DISABLE | SVC_MODE;
    asm("msr cpsr, %[ps]" : : [ps] "r"(mode));
}

// Turn on interrupts in the ARM processor
void enable_A9_interrupts(void){
    int status = SVC_MODE | INT_ENABLE;
    asm("msr cpsr, %[ps]" : : [ps] "r"(status));
}

// Configure the Generic Interrupt Controller (GIC)
void config_GIC() {
    config_interrupt(79, 1); //configure the PS2 keyboard parallel port
    // Set Interrupt Priority Mask Register (ICCPMR). Enable interrupts of all priorities
    int address = MPCORE_GIC_CPUIF + ICCPMR;
    *((int *) address) = 0xFFFF;
    // Set CPU Interface Control Register (ICCICR). Enable signaling of interrupts
    address = MPCORE_GIC_CPUIF;
    *((int *) address) = 1;
    // Configure the Distributor Control Register (ICDDCR) to send pending interrupts to CPUs
    address = MPCORE_GIC_DIST;
    *((int *) address) = 1;
}

// Configure Set Enable Registers (ICDISERn) and Interrupt Processor Target Registers (ICDIPTRn). 
// The default (reset) values are used for other registers in the GIC.
void config_interrupt (int N, int CPU_target) {
    int regOffset, idx, value, address;
    // Configure the Interrupt Set-Enable Registers (ICDISERn).
    regOffset = (N >> 3) & 0xFFFFFFFC;
    idx = N & 0x1F;
    value = 0x1 << idx;
    address = 0xFFFED100 + regOffset;
    // Now that we know the register address and value, set the appropriate bit
    *(int *)address |= value;
    // Configure the Interrupt Processor Targets Register (ICDIPTRn)
    regOffset = (N & 0xFFFFFFFC);
    idx = N & 0x3;
    address = 0xFFFED800 + regOffset + idx;
    // Now that we know the register address and value, write to (only) the appropriate byte
    *(char *)address = (char) CPU_target;
}

void config_PS2(){
    volatile int * PS2_ptr = (int *)PS2_BASE; 
    volatile int * PS2_ptr_interrupt = (int *)(PS2_BASE+4); 
    *(PS2_ptr_interrupt) = 0x1;
}

void PS2_ISR(void){
    volatile int * PS2_ptr = (int *)PS2_BASE;
    int PS2_data, RVALID;
    // PS/2 mouse needs to be reset (must be already plugged in)
    PS2_data = *(PS2_ptr); // read the Data register in the PS/2 port
    RVALID = PS2_data & 0x8000; // extract the RVALID field
    if (RVALID) {
    /* shift the next data byte into the display */
        byte1 = byte2;
        byte2 = byte3;
        byte3 = PS2_data & 0xFF;
        printf(byte2);
        printf(byte3);
        if ((byte2 == (char)0xF0) && (byte3 == (char)0x29)){
            if (play){
                bird_coor -= flap_height;
                falling = 1;
            }
            else play = true;
	}
    }
    return;
}